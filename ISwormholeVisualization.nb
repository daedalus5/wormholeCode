(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     34543,        841]
NotebookOptionsPosition[     33302,        802]
NotebookOutlinePosition[     33658,        818]
CellTagsIndexPosition[     33615,        815]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "clear", " ", "equations", " ", "and", " ", "variable", " ", 
   "assignments"}], "*)"}]], "Input",
 CellChangeTimes->{{3.646230972149395*^9, 3.64623097717737*^9}, {
  3.647783636300111*^9, 3.6477836429480867`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "l", ",", "\[Theta]", ",", "\[Phi]", ",", "pl", ",", "p\[Theta]", ",", 
   "\[Theta]cs", ",", "\[Phi]cs", ",", "lc", ",", "\[Theta]c", ",", "\[Phi]c",
    ",", "b", ",", "B", ",", " ", "M", ",", "r", ",", "R", ",", "\[Rho]", ",",
    "a", ",", "W", ",", "T", ",", "newImage", ",", "xDim", ",", "yDim"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "r", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "RC", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "l", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\[Theta]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "\[Phi]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "pl", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "p\[Theta]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "sol", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "dim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "solns", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", "newPixels", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6462273615734577`*^9, 3.6462274042987213`*^9}, {
  3.646227518642642*^9, 3.646227590037677*^9}, {3.646227657460856*^9, 
  3.646227658108025*^9}, {3.6462281026331263`*^9, 3.646228161487039*^9}, {
  3.646228709941217*^9, 3.646228717502594*^9}, {3.646229594567725*^9, 
  3.646229594742387*^9}, {3.6462443119833517`*^9, 3.646244314373234*^9}, {
  3.646245804043962*^9, 3.6462458042126493`*^9}, {3.646406545647628*^9, 
  3.6464065467334757`*^9}, {3.646407255739409*^9, 3.646407328002819*^9}, {
  3.646422771064271*^9, 3.6464227746478558`*^9}, {3.646422924783847*^9, 
  3.646422929512103*^9}, {3.6464231029919357`*^9, 3.6464231056713743`*^9}, {
  3.646439688600894*^9, 3.6464396966391153`*^9}, {3.646439988268764*^9, 
  3.646440030301265*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"r", "[", "l", "]"}], ":", " ", 
   RowBox[{
   "radius", " ", "as", " ", "a", " ", "function", " ", "of", " ", "distance",
     " ", "through", " ", "wormhole", " ", 
    RowBox[{"(", 
     RowBox[{"as", " ", "specified", " ", "in", " ", 
      StyleBox["Visualizing",
       FontSlant->"Italic"], 
      StyleBox[" ",
       FontSlant->"Italic"], 
      StyleBox[
       RowBox[{"Interstellar", "'"}],
       FontSlant->"Italic"], 
      StyleBox["s",
       FontSlant->"Italic"], 
      StyleBox[" ",
       FontSlant->"Italic"], 
      StyleBox["Wormhole",
       FontSlant->"Italic"]}], ")"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6462312685782022`*^9, 3.646231274094564*^9}, {
  3.647783391869048*^9, 3.647783405794805*^9}, {3.64778357982778*^9, 
  3.647783620269393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "l_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Rho]", "+", 
         RowBox[{"M", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Abs", "[", "l", "]"}], "-", "a"}], ")"}]}], 
              RowBox[{"Pi", "*", "M"}]], "*", 
             RowBox[{"ArcTan", "[", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Abs", "[", "l", "]"}], "-", "a"}], ")"}]}], 
               RowBox[{"Pi", "*", "M"}]], "]"}]}], "-", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"Log", "[", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 FractionBox[
                  RowBox[{"2", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Abs", "[", "l", "]"}], "-", "a"}], ")"}]}], 
                  RowBox[{"Pi", "*", "M"}]], ")"}], "2"]}], "]"}]}]}], 
           ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "l", "]"}], ">", "a"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{
         RowBox[{"Abs", "[", "l", "]"}], "\[LessEqual]", "a"}]}], "}"}]}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.646144639082066*^9, 3.646144646351256*^9}, {
  3.6461448221719093`*^9, 3.646144910874894*^9}, {3.646227698485718*^9, 
  3.646227705635212*^9}, {3.64622799243883*^9, 3.64622802811226*^9}, {
  3.646228090148265*^9, 3.646228094619423*^9}, {3.646228579759927*^9, 
  3.646228584639974*^9}, {3.646228793916101*^9, 3.646228821755382*^9}, {
  3.646243667241618*^9, 3.6462436744962673`*^9}, {3.646243986202877*^9, 
  3.646243989496688*^9}, {3.646244101579198*^9, 3.6462441193682213`*^9}, {
  3.646406110016407*^9, 3.646406118927663*^9}, {3.646406552222496*^9, 
  3.646406553582284*^9}, {3.646406588665246*^9, 3.646406615040031*^9}, {
  3.6464066966361513`*^9, 3.646406717764421*^9}, {3.646419666326065*^9, 
  3.646419882775354*^9}, {3.646420284418474*^9, 3.6464202877304897`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"r", "[", "l", "]"}], ",", "l"}], "]"}], ":", " ", 
   RowBox[{"derivative", " ", "of", " ", "radius", " ", "function"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6464203125885687`*^9, 3.6464203219970913`*^9}, {
  3.647783414972303*^9, 3.647783428867852*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", "l_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["2", "Pi"], 
         FractionBox[
          RowBox[{"Abs", "[", "l", "]"}], "l"], 
         RowBox[{"ArcTan", "[", 
          FractionBox[
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", "l", "]"}], "-", "a"}], ")"}]}], 
           RowBox[{"Pi", "*", "M"}]], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "l", "]"}], ">", "a"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"Abs", "[", "l", "]"}], "\[LessEqual]", "a"}]}], "}"}]}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.646419911942609*^9, 3.64641995980408*^9}, {
  3.646420186896541*^9, 3.646420233591114*^9}, {3.64642029402409*^9, 
  3.64642030767935*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"lensing", " ", 
    RowBox[{"parameters", ":", " ", 
     RowBox[{
     "a", " ", "is", " ", "the", " ", "length", " ", "of", " ", "the", " ", 
      "cylindrical", " ", "region", " ", "of", " ", "the", " ", "wormhole", 
      " ", "and", " ", "\[Rho]"}]}]}], ",", " ", 
   RowBox[{"its", " ", 
    RowBox[{"radius", ".", " ", "W"}], " ", "is", " ", "the", " ", 
    RowBox[{"wormhole", "'"}], "s", " ", "lensing", " ", "width"}], ",", " ", 
   
   RowBox[{
   "M", " ", "represents", " ", "the", " ", "gentleness", " ", "of", " ", 
    "the", " ", "transition", " ", "from", " ", "the", " ", 
    RowBox[{"wormwhole", "'"}], "s", " ", "cylindrical", " ", "to", " ", 
    "its", " ", "flat", " ", "region"}], ",", " ", 
   RowBox[{"and", " ", "T", " ", "is", " ", "the", " ", "time", " ", 
    RowBox[{"(", "distance", ")"}], " ", "to", " ", "which", " ", "the", " ", 
    "numerical", " ", "solver", " ", "will", " ", "integrate", " ", 
    "backwards", " ", "along", " ", "each", " ", 
    RowBox[{"photon", "'"}], "s", " ", "trajectory"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.646229374547814*^9, 3.6462294298237*^9}, {
   3.6464068951388702`*^9, 3.646406895722775*^9}, {3.6477834359712048`*^9, 
   3.647783448897031*^9}, {3.647783484360468*^9, 3.647783533350263*^9}, {
   3.647783670782797*^9, 3.647783677765952*^9}, 3.647783741963305*^9, {
   3.6477838405687323`*^9, 3.647783965880382*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"\[Rho]", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"0.05", " ", "\[Rho]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"W", " ", "/", " ", "1.42953"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"-", "1000000"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQHRqd9muB1mvHV4GffoPoHE5ProVA2uvcNyEQ7aQc
nwaiE34E5oLof9dCWkB006pkMH3tyO83y4E027krb0H0tDzu+pVAmqtBEkzL
1bz/OF/3tWNI52cwPW8784aFQHrLDXkw7anQJbYYSPuVMIuD6GB91V0g2map
BZietb4wZhmQ7mOdBqZZvhxIBtFTNj9MAdGRvydLLwfSxdd2gGmv1x/tVwBp
9wUTnUC0eKqf/EogvUo3Bkyv2fp97iUg/UOjbjGIPul5T/ErkC6I26wEoiP4
V6dV2r92vJO/MR1EVz3qtewD0n8u8NqB6EKmvdVTgHTdB70mEA0AgqWhDQ==

  "]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "fixed", " ", "camera", " ", "location", " ", "in", " ", "global", " ", 
   "coordinates"}], "*)"}]], "Input",
 CellChangeTimes->{{3.64622996715742*^9, 3.646229973627965*^9}, {
  3.64778354557351*^9, 3.6477835490131693`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"lc", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "6.25"}], " ", "\[Rho]"}], "-", "a"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lc", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "\[Rho]"}], "-", "a"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]c", "=", 
     RowBox[{"Pi", "/", "16"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]c", "=", "0"}], ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQHepg3rxQ67Vj8w+TdhA9U+ZvN4iOCrncD6KrhcM9
qnRfO+4LqwDTdVu08muA9B0+GzB9z5pFsxZIO21xBtNHgs4mguim3K9guupY
6W8Q7co3E0z7/NjxbzqQPuN/BUwfKO3bsBBIX6q9DaZ7dJJjFwFpvtulYPrO
tdVSi4H0EvetYJrv57PIZUCanfMbmO47Xau8Ckh/610JpuO78qw3AulJlYfB
dNB17cC9QPqBfDiY1uXcufMEkD4+7yWYtkpduu00yP0zD4Jplfzn6mdB+k24
NUB0cPvhDReA9KMlV8B0zsSKeZeAdFnWTTD9295snYbea8dFyt5geu9Hy6u6
QPrLSzcwfedD42dHIO3n2gam9R3PtEyxf+14/ltXO4gGAA4Ewu8=
  "]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "constants", " ", "of", " ", "motion", " ", "from", " ", "Hamiltonian"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.647783552893015*^9, 3.647783556037065*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", 
    RowBox[{"\[Theta]cs_", ",", "\[Phi]cs_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"r", "[", "lc", "]"}]}], " ", 
    RowBox[{"Sin", "[", "\[Theta]c", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]cs", "]"}], 
    RowBox[{"Sin", "[", "\[Phi]cs", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B", "[", 
    RowBox[{"\[Theta]cs_", ",", "\[Phi]cs_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"r", "[", "lc", "]"}], "2"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Theta]cs", "]"}], "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]cs", "]"}], "2"], 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Phi]cs", "]"}], "2"]}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6462276597736673`*^9, 3.646227662466722*^9}, {
   3.646228155215177*^9, 3.64622822073929*^9}, {3.64622841969377*^9, 
   3.646228419886098*^9}, {3.646229549777226*^9, 3.64622955772094*^9}, {
   3.646242738880052*^9, 3.646242768296476*^9}, 3.64624281311792*^9, {
   3.646243716845668*^9, 3.646243721045435*^9}, {3.646245683529932*^9, 
   3.6462457160716333`*^9}, {3.646405988297843*^9, 3.646406014564238*^9}, {
   3.646406751091851*^9, 3.6464067764360027`*^9}, {3.64640685919068*^9, 
   3.64640686247727*^9}, {3.646419573960791*^9, 3.646419577521427*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Hamilton", "'"}], "s", " ", "equations", " ", "of", " ", 
   "motion"}], "*)"}]], "Input",
 CellChangeTimes->{{3.646229478062195*^9, 3.646229484939117*^9}, {
  3.647783566212256*^9, 3.647783567508057*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", "[", 
   RowBox[{"\[Theta]cs_", ",", "\[Phi]cs_"}], "]"}], ":=", 
  RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"l", "'"}], "[", "t", "]"}], "\[Equal]", " ", 
       RowBox[{"pl", "[", "t", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"l", "[", "0", "]"}], "\[Equal]", "lc"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Equal]", " ", 
       FractionBox[
        RowBox[{"p\[Theta]", "[", "t", "]"}], 
        SuperscriptBox[
         RowBox[{"r", "[", 
          RowBox[{"l", "[", "t", "]"}], "]"}], "2"]]}], ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", " ", "\[Theta]c"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "\[Equal]", " ", 
       FractionBox[
        RowBox[{"b", "[", 
         RowBox[{"\[Theta]cs", ",", 
          RowBox[{"\[Phi]cs", "+", "Pi"}]}], "]"}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"r", "[", 
           RowBox[{"l", "[", "t", "]"}], "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "2"]}]]}], ",", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", " ", "\[Phi]c"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"pl", "'"}], "[", "t", "]"}], "\[Equal]", " ", 
       RowBox[{
        RowBox[{"B", "[", 
         RowBox[{"\[Theta]cs", ",", 
          RowBox[{"\[Phi]cs", "+", "Pi"}]}], "]"}], " ", 
        FractionBox[
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"l", "[", "t", "]"}], "]"}], " "}], 
         SuperscriptBox[
          RowBox[{"r", "[", 
           RowBox[{"l", "[", "t", "]"}], "]"}], "3"]]}]}], ",", 
      RowBox[{
       RowBox[{"pl", "[", "0", "]"}], "\[Equal]", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]cs", "]"}]}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]cs", "+", "Pi"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"p\[Theta]", "'"}], "[", "t", "]"}], "\[Equal]", " ", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"b", "[", 
           RowBox[{"\[Theta]cs", ",", 
            RowBox[{"\[Phi]cs", "+", "Pi"}]}], "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"r", "[", 
           RowBox[{"l", "[", "t", "]"}], "]"}], "2"]], 
        FractionBox[
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "3"]]}]}], ",", 
      RowBox[{
       RowBox[{"p\[Theta]", "[", "0", "]"}], "\[Equal]", " ", 
       RowBox[{
        RowBox[{"r", "[", "lc", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]cs", "]"}]}]}]}], " ", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "l", ",", "\[Theta]", ",", "\[Phi]", ",", "pl", ",", "p\[Theta]"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6462284017593803`*^9, 3.646228412964389*^9}, 
   3.6462287035909557`*^9, {3.646228735892809*^9, 3.646228758491168*^9}, {
   3.646228838228319*^9, 3.64622898177709*^9}, {3.6462290451657143`*^9, 
   3.6462291579594507`*^9}, {3.646230088172262*^9, 3.646230093856867*^9}, {
   3.646230230761742*^9, 3.6462304328210907`*^9}, {3.646230512552874*^9, 
   3.646230608843617*^9}, {3.6462307738455467`*^9, 3.6462308237873087`*^9}, {
   3.64623140509844*^9, 3.646231413621854*^9}, {3.6462423078377743`*^9, 
   3.646242346896901*^9}, {3.646242677216408*^9, 3.646242678976345*^9}, {
   3.646242839773288*^9, 3.6462428663242893`*^9}, {3.6462434855473022`*^9, 
   3.646243509266173*^9}, {3.646243553064762*^9, 3.646243553568475*^9}, {
   3.646243681054233*^9, 3.646243697923636*^9}, {3.646243744666739*^9, 
   3.6462437578189*^9}, {3.6462443529589853`*^9, 3.646244353541053*^9}, {
   3.646244897777585*^9, 3.6462449021850557`*^9}, {3.646245370944119*^9, 
   3.6462453766154957`*^9}, {3.646245720957427*^9, 3.6462457771705713`*^9}, {
   3.646405689614266*^9, 3.646405693221719*^9}, {3.64640602898809*^9, 
   3.646406029268606*^9}, {3.646406360741356*^9, 3.6464063730907507`*^9}, {
   3.646406463030161*^9, 3.64640647062854*^9}, {3.646406636275917*^9, 
   3.646406644938366*^9}, {3.646406887324032*^9, 3.6464068886837893`*^9}, {
   3.646407022053708*^9, 3.646407049922525*^9}, {3.646407182985591*^9, 
   3.646407183154792*^9}, {3.646408352557336*^9, 3.64640838069527*^9}, {
   3.646419564321391*^9, 3.646419647204445*^9}, {3.6464203342760563`*^9, 
   3.646420334579829*^9}, {3.647718826200955*^9, 3.647718827532345*^9}, {
   3.647786282358737*^9, 3.647786294237287*^9}, {3.647884023819264*^9, 
   3.647884035141412*^9}, {3.64788533090545*^9, 3.647885342736891*^9}, {
   3.647889748557846*^9, 3.6478897574507236`*^9}, {3.647897143592173*^9, 
   3.6478971530305243`*^9}, {3.647973703876745*^9, 3.64797371257969*^9}, {
   3.648065215618519*^9, 3.6480652256573143`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"input", " ", "image", " ", "dimensions"}], "*)"}]], "Input",
 CellChangeTimes->{{3.646424439028808*^9, 3.64642444868546*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"ImageDimensions", "[", 
    RowBox[{"(*", 
     RowBox[{
     "insert", " ", "one", " ", "of", " ", "your", " ", "two", " ", "images", 
      " ", "here"}], "*)"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xDim", "=", 
   RowBox[{"dim", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yDim", "=", 
   RowBox[{"dim", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.646404908753413*^9, 3.646404965047521*^9}, {
   3.6464051764605207`*^9, 3.646405182291325*^9}, {3.647718938126821*^9, 
   3.647718957050222*^9}, 3.647719395031127*^9, 3.647719799143478*^9, 
   3.64780401038496*^9, {3.6478041873536386`*^9, 3.6478041932778177`*^9}, 
   3.647804313723866*^9, {3.64790305726156*^9, 3.647903063498848*^9}, 
   3.6539351215523033`*^9, {3.653935170106318*^9, 3.6539351810636683`*^9}, {
   3.6571569314262657`*^9, 3.6571569443483973`*^9}, {3.657156978404331*^9, 
   3.657156982036981*^9}, {3.6611938019332657`*^9, 3.661193858763357*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "constructing", " ", "the", " ", "new", " ", "image", " ", "pixel", " ", 
   "by", " ", "pixel"}], "*)"}]], "Input",
 CellChangeTimes->{{3.646424453891667*^9, 3.646424467068665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solns", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "T", "]"}], ",", 
          RowBox[{"\[Phi]", "[", "T", "]"}], ",", 
          RowBox[{"l", "[", "T", "]"}]}], "}"}], "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"\[Theta]cs", ",", "\[Phi]cs"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Phi]cs", ",", 
       RowBox[{"-", "Pi"}], ",", "Pi", ",", 
       RowBox[{"2", " ", 
        RowBox[{"Pi", "/", "xDim"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]cs", ",", "0", ",", "Pi", ",", 
       RowBox[{"Pi", "/", "yDim"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQraejnsWo/dpxhczDUhA9pXpePYj+4S7RAKLzDpxs
B9E8086C6UVSzXdA9AzXOXdBtOCKKE0OIP3f3lELRGvJLDlRofvasVTe7SSI
/nRO4ByYnxoPpoXUkh6B6KxmkccgumlrgGcVkD5X+AxMe7PsW18NpK94am8A
0Wwnxc1qgPQNS11zEL0qYWERiF6Q9B1Mr9nysAJEa/+yqgTRUjXXfk8H0jFn
lv4F0bOLdzvOBNJf/tU7gWizxwfWgWj2XMv1IHoPw9Vn80Hu2Lv/OYjuFH95
7TSQ/tfw5z6Idtylrf0VSKec2KALoucumB4mpffa8USvfDiI5jE4vU4DSNe2
V60H0QBcRqC5
  "]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.6572141906714582`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "the", " ", "two", " ", "images", " ", "represent", " ", "the", " ", 
   "celestial", " ", "spheres", " ", "on", " ", "either", " ", "side", " ", 
   "of", " ", "the", " ", 
   RowBox[{"wormhole", ".", " ", "They"}], " ", "must", " ", "have", " ", 
   "the", " ", "same", " ", "dimensions"}], "*)"}]], "Input",
 CellChangeTimes->{{3.647785984684472*^9, 3.647786009899621*^9}, {
  3.6477890009502363`*^9, 3.647789024853581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"newPixels", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"solns", "[", 
           RowBox[{"[", "x", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "\[GreaterEqual]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PixelValue", "[", 
        RowBox[{"(*", 
         RowBox[{
         "insert", " ", "one", " ", "of", " ", "your", " ", "two", " ", 
          "images", " ", "here"}], "*)"}], 
        RowBox[{",", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["xDim", 
              RowBox[{"2", " ", "Pi"}]], 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"solns", "[", 
                  RowBox[{"[", "x", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"2", " ", "Pi", " ", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"solns", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", "Pi"}], ")"}]}], "]"}]}]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["yDim", "Pi"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"solns", "[", 
                  RowBox[{"[", "x", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"Pi", " ", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"solns", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "/", "Pi"}], "]"}]}]}], 
              ")"}]}]}], "}"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PixelValue", "[", 
        RowBox[{"(*", 
         RowBox[{
         "insert", " ", "your", " ", "other", " ", "picture", " ", "here", 
          " ", 
          RowBox[{"(", 
           RowBox[{"of", " ", "the", " ", "same", " ", "dimensions"}], 
           ")"}]}], "*)"}], 
        RowBox[{",", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             FractionBox["xDim", 
              RowBox[{"2", " ", "Pi"}]], 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"solns", "[", 
                  RowBox[{"[", "x", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"2", " ", "Pi", " ", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"solns", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", "Pi"}], ")"}]}], "]"}]}]}], ")"}]}], ",", 
            RowBox[{
             FractionBox["yDim", "Pi"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"solns", "[", 
                  RowBox[{"[", "x", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"Pi", " ", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"solns", "[", 
                    RowBox[{"[", "x", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"yDim", "+", "1", "-", "y"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "/", "Pi"}], "]"}]}]}], 
              ")"}]}]}], "}"}], "]"}]}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", "yDim", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "xDim", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.646426197504155*^9, 3.64642621727962*^9}, {
   3.646426285584468*^9, 3.646426293712253*^9}, {3.646426368172147*^9, 
   3.646426505091531*^9}, {3.646426535114251*^9, 3.6464265384826927`*^9}, {
   3.6464265726957293`*^9, 3.646426598635854*^9}, {3.6464266343119087`*^9, 
   3.64642666831866*^9}, {3.646426748914259*^9, 3.6464267587835712`*^9}, {
   3.646437407268417*^9, 3.646437412010009*^9}, {3.646451917724688*^9, 
   3.6464519281235723`*^9}, {3.647719603759807*^9, 3.647719606198241*^9}, {
   3.6477196455854397`*^9, 3.6477197072516937`*^9}, {3.647719751143774*^9, 
   3.6477197975313873`*^9}, {3.6477266122470827`*^9, 
   3.6477266282444553`*^9}, {3.647726768083188*^9, 3.6477267814829597`*^9}, {
   3.6477833379969797`*^9, 3.647783367089243*^9}, {3.647784615276884*^9, 
   3.647784623265924*^9}, {3.647784655007495*^9, 3.647784674801301*^9}, {
   3.647784750890836*^9, 3.6477847602618093`*^9}, {3.647784800869514*^9, 
   3.6477848428689127`*^9}, {3.6477848769274397`*^9, 3.647784888164837*^9}, {
   3.6477850734381437`*^9, 3.647785080477007*^9}, {3.6477871266164*^9, 
   3.647787133812862*^9}, {3.647787802770918*^9, 3.647787851818404*^9}, {
   3.647788159516697*^9, 3.647788200332136*^9}, {3.647788333813161*^9, 
   3.6477885354010067`*^9}, {3.647789153370144*^9, 3.647789200051244*^9}, 
   3.647789270920923*^9, {3.647789345206562*^9, 3.647789365448635*^9}, {
   3.647789405479031*^9, 3.64778943919127*^9}, {3.647789487095566*^9, 
   3.647789495659958*^9}, {3.647799065836302*^9, 3.6477991280408688`*^9}, {
   3.647800526915147*^9, 3.647800578824121*^9}, {3.647801043858436*^9, 
   3.6478010764629908`*^9}, {3.647802179770953*^9, 3.647802185024825*^9}, {
   3.6478023375591173`*^9, 3.647802343871142*^9}, {3.647804121946357*^9, 
   3.64780412984062*^9}, {3.647804354017104*^9, 3.647804354280511*^9}, {
   3.647804391519648*^9, 3.647804393975442*^9}, {3.6478179948814363`*^9, 
   3.647818003776195*^9}, {3.647820698523538*^9, 3.647820704362473*^9}, {
   3.647830178361947*^9, 3.6478302030383577`*^9}, {3.6478342630976267`*^9, 
   3.647834323413869*^9}, {3.647859410832795*^9, 3.6478594671583347`*^9}, {
   3.647863879703684*^9, 3.647863901864669*^9}, {3.647866059322356*^9, 
   3.6478660684253902`*^9}, {3.647866845214113*^9, 3.647866849044228*^9}, {
   3.6478672193502693`*^9, 3.647867220045092*^9}, {3.64788219043643*^9, 
   3.647882191322496*^9}, {3.6478823951677103`*^9, 3.6478823989951477`*^9}, {
   3.647882494335507*^9, 3.647882518814137*^9}, 3.6478887956665487`*^9, {
   3.647889184934737*^9, 3.647889267846629*^9}, {3.647889454546023*^9, 
   3.647889479702716*^9}, {3.6478908239221897`*^9, 3.647890962254722*^9}, {
   3.64789115799649*^9, 3.6478911635547123`*^9}, {3.647900409696745*^9, 
   3.647900413277218*^9}, {3.647900443470195*^9, 3.647900448336277*^9}, {
   3.647900673475006*^9, 3.6479007167303047`*^9}, {3.647900771372767*^9, 
   3.6479007908499117`*^9}, 3.647900850643092*^9, 3.647900915378293*^9, {
   3.64790114595266*^9, 3.647901159915053*^9}, {3.647901474230503*^9, 
   3.647901480941319*^9}, 3.647901951212055*^9, {3.647901982663896*^9, 
   3.647902094638587*^9}, {3.647902434538933*^9, 3.64790243480731*^9}, {
   3.6479030670090723`*^9, 3.64790308083455*^9}, {3.6479737471408157`*^9, 
   3.6479737521574383`*^9}, 3.647973791862475*^9, {3.64804200500585*^9, 
   3.648042007518449*^9}, {3.648042049766242*^9, 3.64804205120732*^9}, {
   3.648046354796874*^9, 3.648046355053409*^9}, {3.648046417573867*^9, 
   3.648046430346686*^9}, {3.648046523501606*^9, 3.64804656439111*^9}, {
   3.648048603050344*^9, 3.648048619039042*^9}, {3.648048666851462*^9, 
   3.6480486794368896`*^9}, {3.6480487124273148`*^9, 3.648048712641714*^9}, {
   3.648049376643179*^9, 3.648049376812278*^9}, {3.648049802052614*^9, 
   3.648049802220783*^9}, {3.6480746220246773`*^9, 3.6480746238509293`*^9}, {
   3.648074971217771*^9, 3.64807497968848*^9}, {3.648076553808504*^9, 
   3.648076620700918*^9}, {3.6480772176551313`*^9, 3.648077223068928*^9}, {
   3.648078151040205*^9, 3.648078184121581*^9}, {3.653935187133029*^9, 
   3.653935189474078*^9}, {3.657157012310399*^9, 3.6571570137685537`*^9}, {
   3.657157373719717*^9, 3.657157389904415*^9}, {3.6571574625992947`*^9, 
   3.657157490375997*^9}, {3.661193843384027*^9, 3.661193855323831*^9}, {
   3.661193916172282*^9, 3.661193978608704*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"preparing", " ", "final", " ", "image"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6477202414009037`*^9, 3.647720249076386*^9}, {
  3.661194045583535*^9, 3.661194046535928*^9}}],

Cell[BoxData[
 RowBox[{"Image", "[", "newPixels", "]"}]], "Input",
 CellChangeTimes->{{3.6611940058037148`*^9, 3.661194013465213*^9}, 
   3.661194086343577*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"finalPixels", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PixelValue", "[", 
      RowBox[{"(*", 
       RowBox[{"drag", " ", "newPixels", " ", "image", " ", "here"}], "*)"}], 
      
      RowBox[{",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"x", "\[LessEqual]", 
            RowBox[{
             FractionBox["xDim", "2"], "+", 
             RowBox[{"Mod", "[", 
              RowBox[{"xDim", ",", "2"}], "]"}]}]}], ",", 
           RowBox[{"x", "+", 
            FractionBox["xDim", "2"], "+", 
            RowBox[{"Mod", "[", 
             RowBox[{"xDim", ",", "2"}], "]"}]}], ",", 
           RowBox[{"x", "-", 
            FractionBox["xDim", "2"], "-", 
            RowBox[{"Mod", "[", 
             RowBox[{"xDim", ",", "2"}], "]"}], "+", "1"}]}], "]"}], ",", 
         RowBox[{"yDim", "+", "1", "-", "y"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", "yDim", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "xDim", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.648087788121574*^9, 3.6480879389799213`*^9}, {
  3.648088064190106*^9, 3.648088218559219*^9}, {3.648088963901265*^9, 
  3.6480889822459593`*^9}, {3.6539351915412827`*^9, 3.653935191875782*^9}, {
  3.6571962937216663`*^9, 3.65719630026888*^9}, {3.657227952704342*^9, 
  3.657227955577044*^9}, {3.661194021516527*^9, 3.6611940316898117`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"final", " ", "image"}], "*)"}]], "Input",
 CellChangeTimes->{{3.661194048459208*^9, 3.661194052503545*^9}}],

Cell[BoxData[
 RowBox[{"Image", "[", "finalPixels", "]"}]], "Input",
 CellChangeTimes->{{3.648088254422715*^9, 3.6480882588073473`*^9}}]
},
WindowSize->{804, 763},
WindowMargins->{{15, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 258, 6, 27, "Input"],
Cell[818, 28, 2032, 40, 193, "Input"],
Cell[2853, 70, 837, 24, 43, "Input"],
Cell[3693, 96, 2352, 57, 90, "Input"],
Cell[6048, 155, 352, 9, 27, "Input"],
Cell[6403, 166, 968, 29, 46, "Input"],
Cell[7374, 197, 1453, 27, 88, "Input"],
Cell[8830, 226, 884, 23, 88, "Input"],
Cell[9717, 251, 268, 6, 27, "Input"],
Cell[9988, 259, 993, 27, 73, "Input"],
Cell[10984, 288, 203, 5, 27, "Input"],
Cell[11190, 295, 1441, 35, 48, "Input"],
Cell[12634, 332, 258, 6, 27, "Input"],
Cell[12895, 340, 5294, 121, 258, "Input"],
Cell[18192, 463, 166, 3, 27, "Input"],
Cell[18361, 468, 1091, 23, 58, "Input"],
Cell[19455, 493, 225, 5, 27, "Input"],
Cell[19683, 500, 1285, 32, 58, "Input"],
Cell[20971, 534, 71, 1, 27, "Input"],
Cell[21045, 537, 470, 9, 43, "Input"],
Cell[21518, 548, 9589, 193, 338, "Input"],
Cell[31110, 743, 217, 4, 27, "Input"],
Cell[31330, 749, 160, 3, 27, "Input"],
Cell[31493, 754, 1515, 37, 115, "Input"],
Cell[33011, 793, 148, 3, 27, "Input"],
Cell[33162, 798, 136, 2, 27, "Input"]
}
]
*)

(* End of internal cache information *)
